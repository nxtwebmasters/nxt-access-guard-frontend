<!-- dashboard.component.html -->
<div class="container mx-auto p-4 bg-gray-100 min-h-screen">
  <div class="bg-white p-8 rounded-lg shadow-md max-w-3xl mx-auto">
    <h2 class="text-3xl font-bold text-center text-indigo-700 mb-6">Welcome to Your Dashboard!</h2>

    <div *ngIf="currentUser" class="mb-6 border-b pb-4">
      <h3 class="text-xl font-semibold text-gray-800 mb-2">User Information:</h3>
      <p><strong class="font-medium">Username:</strong> {{ currentUser.username }}</p>
      <p><strong class="font-medium">Email:</strong> {{ currentUser.email }}</p>
      <p><strong class="font-medium">Roles:</strong> {{ currentUser.roles?.join(', ') || 'None' }}</p>
      <p><strong class="font-medium">Permissions:</strong> {{ currentUser.permissions?.join(', ') || 'None' }}</p>
      <p><strong class="font-medium">Email Verified:</strong> {{ currentUser.isVerified ? 'Yes' : 'No' }}</p>
      <p><strong class="font-medium">2FA Enabled:</strong> {{ currentUser.twoFactorEnabled ? 'Yes' : 'No' }}</p>

      <h4 class="text-lg font-medium mt-4">Custom Fields:</h4>
      <ul *ngIf="currentUser.customFields && (currentUser.customFields | keyvalue).length > 0">
        <li *ngFor="let field of currentUser.customFields | keyvalue">
          <strong class="capitalize">{{ field.key }}:</strong> {{ field.value }}
        </li>
      </ul>
      <p *ngIf="!currentUser.customFields || (currentUser.customFields | keyvalue).length === 0" class="text-gray-600 italic">No custom fields defined.</p>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <button routerLink="/profile"
              class="bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition duration-150 ease-in-out">
        Edit Profile & Change Password
      </button>
      <button routerLink="/2fa-setup"
              class="bg-purple-600 text-white py-2 px-4 rounded-md hover:bg-purple-700 transition duration-150 ease-in-out">
        Manage 2FA
      </button>
      <ng-container *ngIf="isAdmin$ | async">
        <button routerLink="/admin"
                class="bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 transition duration-150 ease-in-out">
          Admin Panel
        </button>
      </ng-container>
      <ng-container *ngIf="isManager$ | async">
        <button
                class="bg-yellow-600 text-white py-2 px-4 rounded-md hover:bg-yellow-700 transition duration-150 ease-in-out">
          Manager Specific Tool
        </button>
      </ng-container>
      <button (click)="logout()"
              class="bg-red-600 text-white py-2 px-4 rounded-md hover:bg-red-700 transition duration-150 ease-in-out">
        Logout
      </button>
    </div>

    <div class="mt-6 text-center text-gray-600 italic">
      <p>This is your personalized dashboard. Content here may vary based on your roles and permissions.</p>
      <p>Example of permission-based content:</p>
      <p *ngIf="authService.hasPermission('read:sensitive_data')" class="text-green-700 font-semibold">
        You have access to sensitive data reports!
      </p>
      <p *ngIf="!authService.hasPermission('read:sensitive_data')" class="text-red-700">
        You DO NOT have access to sensitive data reports.
      </p>
    </div>
  </div>
</div>
